<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hanuman Chalisa Pocket Book & Game</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles to enhance the pocket book look */
        @import url('https://fonts.googleapis.com/css2?family=Tinos:ital,wght@0,400;0,700;1,400;1,700&display=swap');
        
        :root {
            /* Define a warm, paper-like palette */
            --color-parchment: #f9f7f4;
            --color-sepia: #4d3a2b;
            --color-border: #a08c6b;
        }

        body {
            background-color: var(--color-parchment);
            font-family: 'Tinos', serif; /* Use a classic, legible serif font */
            color: var(--color-sepia);
            min-height: 100vh;
        }

        .pocket-book {
            max-width: 900px;
            background-color: white;
            border-radius: 8px;
            border: 2px solid var(--color-border);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25), inset 0 0 10px rgba(160, 140, 107, 0.5); /* Inner and outer shadow */
            padding: 2rem 1.5rem;
            margin-top: 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }

        /* Subtle page line for aesthetic */
        .pocket-book::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 1px;
            height: 100%;
            background-color: var(--color-border);
            opacity: 0.5;
            transform: translateX(1.5rem);
        }

        /* Full Text View Styling */
        .stanza-container {
            border-bottom: 1px dashed rgba(77, 58, 43, 0.2);
            padding: 1rem 0;
            margin-bottom: 0.5rem;
        }
        .stanza-container:last-child {
            border-bottom: none;
        }

        /* Responsive grid for the three languages */
        .language-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.5rem;
        }

        @media (min-width: 768px) {
            .language-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 1.5rem;
            }
        }
        
        .sanskrit { font-size: 1.15rem; font-weight: 500; }
        .romanized { font-style: italic; opacity: 0.9; }
        .nepali { font-size: 1.05rem; }

        .title-text {
            text-align: center;
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            line-height: 1.2;
            color: #b91c1c; /* Deep red for emphasis */
            border-bottom: 3px double #b91c1c;
            padding-bottom: 0.5rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        /* Game specific feedback colors */
        .feedback-correct { color: #10b981; } /* Brighter Green */
        .feedback-error { color: #ef4444; } /* Brighter Red */

        /* --- MONKEYTYPE-STYLE INPUT STYLES --- */
        
        /* FIX: Ensure the target text wraps by word */
        #target-text {
            white-space: normal;
            overflow-wrap: break-word; /* Ensures long lines wrap at the word level */
        }

        #typing-wrapper {
            font-family: monospace; /* Monospace for perfect character alignment */
            font-size: 1.25rem;
            letter-spacing: 0.1em;
            font-weight: bold;
            line-height: 1.6;
            padding: 1rem;
            border: 2px solid #a08c6b;
            border-radius: 0.5rem;
            position: relative;
            cursor: text;
            background-color: #fffaf0; /* Light parchment background */
            min-height: 58px; /* Ensure height stability */
            
            /* CSS FIXES: Use word-break: normal; and overflow-wrap: break-word; */
            white-space: normal; 
            word-break: normal; 
            overflow-wrap: break-word;
            
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: height 0.15s ease-out; 
        }

        /* FIXES: Apply wrapping rules to the inner display as well */
        #typed-display {
            white-space: normal; 
            word-break: normal; 
            overflow-wrap: break-word; 
            width: 100%;
        }

        /* The actual input field is transparent but stays in front and focused */
        #user-input {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            border: none;
            color: transparent; /* Hide the native text */
            caret-color: transparent; /* Hide the native caret */
            padding: 1rem;
            z-index: 10;
        }
        
        /* Character Coloring */
        .char.correct { 
            color: #10b981; /* Brighter Green */
        }
        .char.incorrect { 
            color: #ef4444; /* Brighter Red text */
            background-color: #fee2e2; /* Very light red highlight */
            border-radius: 2px; 
            box-shadow: 0 0 1px #ef4444;
        }
        .char.untyped { 
            color: var(--color-sepia); 
            opacity: 0.6; /* Slightly less faded untyped text for better readability */
        }
        
        /* The custom blinking cursor. */
        .char.cursor { 
            border-left: 3px solid #b91c1c; /* Thicker blinking bar */
            background-color: #fef2f2; /* Very light red background highlight */
            color: var(--color-sepia); 
            animation: blink 0.8s step-end infinite; /* Slightly faster blink */
            padding-left: 1px; /* Small push to the right for the bar to sit next to the character */
            margin-right: -1px; /* Counteract the padding to avoid layout shift */
        }

        @keyframes blink {
            from, to { border-color: #b91c1c; }
            50% { border-color: transparent; } /* Blink by hiding the border */
        }
    </style>
</head>
<body class="flex justify-center">
    <div id="app" class="pocket-book w-full max-w-4xl rounded-xl">
        <h1 class="title-text">‡§∂‡•ç‡§∞‡•Ä ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§ö‡§æ‡§≤‡•Ä‡§∏‡§æ (Memory & Typing Challenge)</h1>
        <p id="game-subtitle" class="text-center text-sm mb-6 opacity-75">Memorize and reconstruct the verses using **simplified English characters** (using aa, ee, oo for long vowels). Get instant feedback on every character!</p>
        
        <!-- Game Interface -->
        <div id="game-container" class="space-y-6">
            
            <!-- Progress, Line Selector, and Live Stats Bar -->
            <div class="flex flex-col space-y-2">
                <!-- Progress and Line Selector -->
                <div class="flex flex-col sm:flex-row justify-between items-center text-red-700 pb-2 border-b border-amber-300">
                    <div id="progress-display" class="bg-red-100 px-3 py-1 rounded-full shadow-inner text-sm mb-2 sm:mb-0">Line 0 / 83</div>
                    <!-- Line Selector Dropdown -->
                    <select id="line-selector" class="px-3 py-1 border border-red-300 rounded-lg text-sm bg-white shadow-md cursor-pointer hover:border-red-500 transition duration-150 w-full sm:w-auto">
                        <!-- Options will be populated by JS -->
                    </select>
                </div>
                <!-- New Stats Bar (Hidden initially) -->
                <div id="stats-bar" class="flex justify-between items-center bg-gray-100 p-3 rounded-lg text-sm font-semibold shadow-md hidden">
                    <div class="flex flex-col items-center flex-1">
                        <span class="text-xs text-gray-500">WPM</span>
                        <span id="wpm-display" class="text-xl text-green-700 font-extrabold">0</span>
                    </div>
                    <div class="flex flex-col items-center flex-1 border-x border-gray-300 mx-2 px-2">
                        <span class="text-xs text-gray-500">Accuracy</span>
                        <span id="accuracy-display" class="text-xl text-amber-700 font-extrabold">0%</span>
                    </div>
                    <div class="flex flex-col items-center flex-1">
                        <span class="text-xs text-gray-500">Score</span>
                        <span id="score-display" class="text-xl text-red-700 font-extrabold">0</span>
                    </div>
                </div>
            </div>

            <!-- Start Button / Completion Message -->
            <div id="start-screen" class="text-center pt-4">
                <p class="mb-6 text-lg">Click the button to begin the challenge and test your knowledge of the sacred text. Use the **Line Selector** above to jump to any stanza.</p>
                <button id="start-button" class="px-8 py-3 bg-red-700 text-white font-bold rounded-full shadow-xl transition duration-200 transform hover:scale-105 active:scale-100 hover:bg-red-800 focus:outline-none">
                    Start Learning Challenge
                </button>
            </div>

            <!-- Challenge Area (Hidden initially) -->
            <div id="challenge-area" class="hidden space-y-6 pt-4 border-t border-dashed border-red-300">
                
                <h3 class="text-lg font-bold text-center text-red-700" id="line-type-header">Invocation (‡§¶‡•ã‡§π‡§æ)</h3>

                <!-- The line to be typed (Romanized) -->
                <div class="p-4 bg-amber-50 rounded-xl shadow-inner border border-amber-200">
                    <p class="text-xl font-bold text-center italic text-amber-900" id="target-text">Loading...</p>
                </div>
                
                <!-- Hints (Sanskrit and Nepali) -->
                <div class="flex flex-col md:flex-row md:space-x-4">
                    <div class="w-full md:w-1/2 p-3 bg-gray-50 rounded-lg text-sm mb-3 md:mb-0 border">
                        <span class="font-bold text-red-700">Sanskrit Hint:</span> <span id="sanskrit-hint" class="sanskrit">...</span>
                    </div>
                    <div class="w-full md:w-1/2 p-3 bg-gray-50 rounded-lg text-sm border">
                        <span class="font-bold text-red-700">Nepali Hint:</span> <span id="nepali-hint" class="nepali">...</span>
                    </div>
                </div>

                <!-- Typing Display Area -->
                <div id="typing-wrapper" class="w-full p-3 focus-within:border-red-600 focus-within:ring-red-600 focus-within:ring-1 transition-all duration-150" tabindex="0">
                    <div id="typed-display" class="w-full">
                        <!-- Colored text rendering will go here -->
                    </div>
                    <!-- Hidden input field to capture actual text and manage focus/cursor -->
                    <!-- Added spellcheck=false and autocorrect=off to eliminate the "curly underline" -->
                    <input type="text" id="user-input" class="p-0 m-0" disabled autocomplete="off" spellcheck="false" autocorrect="off">
                </div>
                
                <!-- Feedback Message -->
                <p id="feedback-message" class="text-center font-bold h-6"></p>
                
                <!-- Skip/Next Button -->
                <div class="flex justify-center">
                    <button id="next-button" class="px-6 py-2 bg-green-700 text-white font-bold rounded-lg shadow-md hover:bg-green-800 transition duration-150" disabled>
                        Next Line (or press Enter)
                    </button>
                </div>
            </div>

            <!-- Full Text View Toggle (For reference) -->
            <div class="text-center pt-4 border-t border-amber-700/50">
                <button id="toggle-full-text" class="text-red-700 text-sm hover:underline">
                    View Full Chalisa Text
                </button>
            </div>
            
            <div id="full-text-display" class="hidden mt-4">
                <!-- Full Chalisa will be rendered here if toggled -->
            </div>
        </div>
    </div>

    <script>
        // Data for the complete Hanuman Chalisa (Doha, Chaupai, and Closing Doha)
        // NOTE: Romanized transliteration has been corrected for phonetic accuracy using 
        // simplified ASCII: (aa, ee, oo for long vowels, sh for '‡§∂', ch for '‡§ö', etc.)
        const chalisaData = [
            // Invocation (Dohas)
            { type: 'invocation', sanskrit: '‡§∂‡•ç‡§∞‡•Ä‡§ó‡•Å‡§∞‡•Å ‡§ö‡§∞‡§® ‡§∏‡§∞‡•ã‡§ú ‡§∞‡§ú, ‡§®‡§ø‡§ú ‡§Æ‡§®‡•Å ‡§Æ‡•Å‡§ï‡•Å‡§∞ ‡§∏‡•Å‡§ß‡§æ‡§∞‡§ø‡•§ ‡§¨‡§∞‡§®‡§â‡§Å ‡§∞‡§ò‡•Å‡§¨‡§∞ ‡§¨‡§ø‡§Æ‡§≤ ‡§ú‡§∏‡•Å, ‡§ú‡•ã ‡§¶‡§æ‡§Ø‡§ï‡•Å ‡§´‡§≤ ‡§ö‡§æ‡§∞‡§ø‡••', romanized: 'Shri Guru charan saroj raj, nij manu mukur sudhari. Baranau Raghuvar vimal jasu, jo daayaku phal chaari.', nepali: '‡§∂‡•ç‡§∞‡•Ä‡§ó‡•Å‡§∞‡•Å ‡§ö‡§∞‡§£ ‡§∏‡§∞‡•ã‡§ú ‡§∞‡§ú, ‡§®‡§ø‡§ú ‡§Æ‡§® ‡§Æ‡•Å‡§ï‡•Å‡§∞ ‡§∏‡•Å‡§ß‡§æ‡§∞‡§ø‡•§ ‡§¨‡§∞‡§®‡§â‡§Å ‡§∞‡§ò‡•Å‡§µ‡§∞ ‡§µ‡§ø‡§Æ‡§≤ ‡§ú‡§∏‡•Å, ‡§ú‡•ã ‡§¶‡§æ‡§Ø‡§ï ‡§´‡§≤ ‡§ö‡§æ‡§∞‡§ø‡••' },
            { type: 'invocation', sanskrit: '‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§π‡•Ä‡§® ‡§§‡§®‡•Å ‡§ú‡§æ‡§®‡§ø‡§ï‡•á, ‡§∏‡•Å‡§Æ‡§ø‡§∞‡•å‡§Ç ‡§™‡§µ‡§®‡§ï‡•Å‡§Æ‡§æ‡§∞‡•§ ‡§¨‡§≤ ‡§¨‡•Å‡§ß‡§ø ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ ‡§¶‡•á‡§π‡•Å ‡§Æ‡•ã‡§π‡§ø‡§Ç, ‡§π‡§∞‡§π‡•Å ‡§ï‡§≤‡•á‡§∏ ‡§¨‡§ø‡§ï‡§æ‡§∞‡••', romanized: 'Buddhiheen tanu jaanike, sumirau pavan kumaar. Bal budhi vidya dehu mohi, harahu kales vikaar.', nepali: '‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§π‡•Ä‡§® ‡§§‡§®‡•Å ‡§ú‡§æ‡§®‡§ø‡§ï‡•á, ‡§∏‡•Å‡§Æ‡§ø‡§∞‡•å‡§Ç ‡§™‡§µ‡§®‡§ï‡•Å‡§Æ‡§æ‡§∞‡•§ ‡§¨‡§≤ ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ ‡§¶‡•á‡§π‡•Å ‡§Æ‡•ã‡§π‡§ø, ‡§π‡§∞‡§π‡•Å ‡§ï‡§≤‡•á‡§∂ ‡§µ‡§ø‡§ï‡§æ‡§∞‡••' },

            // Chaupai Stanzas (1-40, 80 lines)
            { type: 'chaupai', sanskrit: '‡§ú‡§Ø ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§ú‡•ç‡§û‡§æ‡§® ‡§ó‡•Å‡§® ‡§∏‡§æ‡§ó‡§∞‡•§', romanized: 'Jai Hanuman gyaan gun saagar.', nepali: '‡§ú‡§Ø ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§ú‡•ç‡§û‡§æ‡§® ‡§ó‡•Å‡§£ ‡§∏‡§æ‡§ó‡§∞‡•§' },
            { type: 'chaupai', sanskrit: '‡§ú‡§Ø ‡§ï‡§™‡•Ä‡§∏ ‡§§‡§ø‡§π‡•Å‡§Å ‡§≤‡•ã‡§ï ‡§â‡§ú‡§æ‡§ó‡§∞‡••', romanized: 'Jai Kapeesh tihun lok ujaagar.', nepali: '‡§ú‡§Ø ‡§ï‡§™‡•Ä‡§∂ ‡§§‡§ø‡§π‡•Å‡§Å ‡§≤‡•ã‡§ï ‡§â‡§ú‡§æ‡§ó‡§∞‡••' },
            { type: 'chaupai', sanskrit: '‡§∞‡§æ‡§Æ ‡§¶‡•Ç‡§§ ‡§Ö‡§§‡•Å‡§≤‡§ø‡§§ ‡§¨‡§≤ ‡§ß‡§æ‡§Æ‡§æ‡•§', romanized: 'Raam doot atulit bal dhaamaa.', nepali: '‡§∞‡§æ‡§Æ ‡§¶‡•Ç‡§§ ‡§Ö‡§§‡•Å‡§≤‡§ø‡§§ ‡§¨‡§≤ ‡§ß‡§æ‡§Æ‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§Ö‡§û‡•ç‡§ú‡§®‡§ø ‡§™‡•Å‡§§‡•ç‡§∞ ‡§™‡§µ‡§®‡§∏‡•Å‡§§ ‡§®‡§æ‡§Æ‡§æ‡••', romanized: 'Anjani putra pawansut naamaa.', nepali: '‡§Ö‡§û‡•ç‡§ú‡§®‡§ø ‡§™‡•Å‡§§‡•ç‡§∞ ‡§™‡§µ‡§®‡§∏‡•Å‡§§ ‡§®‡§æ‡§Æ‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§Æ‡§π‡§æ‡§µ‡•Ä‡§∞ ‡§µ‡§ø‡§ï‡•ç‡§∞‡§Æ ‡§¨‡§ú‡§∞‡§ô‡•ç‡§ó‡•Ä‡•§', romanized: 'Mahaavir vikram Bajrangi.', nepali: '‡§Æ‡§π‡§æ‡§µ‡•Ä‡§∞ ‡§µ‡§ø‡§ï‡•ç‡§∞‡§Æ ‡§¨‡§ú‡§∞‡§ô‡•ç‡§ó‡•Ä‡•§' },
            { type: 'chaupai', sanskrit: '‡§ï‡•Å‡§Æ‡§§‡§ø ‡§®‡§ø‡§µ‡§æ‡§∞ ‡§∏‡•Å‡§Æ‡§§‡§ø ‡§ï‡•á ‡§∏‡§ô‡•ç‡§ó‡•Ä‡••', romanized: 'Kumati nivaar sumati ke sangi.', nepali: '‡§ï‡•Å‡§Æ‡§§‡§ø ‡§®‡§ø‡§µ‡§æ‡§∞ ‡§∏‡•Å‡§Æ‡§§‡§ø ‡§ï‡•á ‡§∏‡§ô‡•ç‡§ó‡•Ä‡••' },
            { type: 'chaupai', sanskrit: '‡§ï‡§û‡•ç‡§ö‡§® ‡§¨‡§∞‡§® ‡§¨‡§ø‡§∞‡§æ‡§ú ‡§∏‡•Å‡§¨‡•á‡§∏‡§æ‡•§', romanized: 'Kanchan baran viraaj subesaa.', nepali: '‡§ï‡§û‡•ç‡§ö‡§® ‡§µ‡§∞‡§£ ‡§µ‡§ø‡§∞‡§æ‡§ú ‡§∏‡•Å‡§µ‡•á‡§∂‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§ï‡§æ‡§®‡§® ‡§ï‡•Å‡§£‡•ç‡§°‡§≤ ‡§ï‡•Å‡§û‡•ç‡§ö‡§ø‡§§ ‡§ï‡•á‡§∏‡§æ‡••', romanized: 'Kaanan kundal kunchit kesaa.', nepali: '‡§ï‡§æ‡§®‡§® ‡§ï‡•Å‡§£‡•ç‡§°‡§≤ ‡§ï‡•Å‡§û‡•ç‡§ö‡§ø‡§§ ‡§ï‡•á‡§∂‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§π‡§æ‡§• ‡§¨‡§ú‡•ç‡§∞ ‡§î ‡§ß‡•ç‡§µ‡§ú‡§æ ‡§¨‡§ø‡§∞‡§æ‡§ú‡•à‡•§', romanized: 'Haath vajra au dhwaj biraaje.', nepali: '‡§π‡§æ‡§• ‡§µ‡§ú‡•ç‡§∞ ‡§î ‡§ß‡•ç‡§µ‡§ú‡§æ ‡§µ‡§ø‡§∞‡§æ‡§ú‡•à‡•§' },
            { type: 'chaupai', sanskrit: '‡§ï‡§æ‡§Å‡§ß‡•á ‡§Æ‡•Ç‡§Å‡§ú ‡§ú‡§®‡•á‡§ä ‡§∏‡§æ‡§ú‡•à‡••', romanized: 'Kaandhe moonj janeu saaje.', nepali: '‡§ï‡§æ‡§Å‡§ß‡•á ‡§Æ‡•Ç‡§Å‡§ú ‡§ú‡§®‡•á‡§ä ‡§∏‡§æ‡§ú‡•à‡••' },
            { type: 'chaupai', sanskrit: '‡§∂‡§Ç‡§ï‡§∞ ‡§∏‡•Å‡§µ‡§® ‡§ï‡•á‡§∏‡§∞‡•Ä ‡§®‡§®‡•ç‡§¶‡§®‡•§', romanized: 'Shankar suvan Kesari Nandan.', nepali: '‡§∂‡§ô‡•ç‡§ï‡§∞ ‡§∏‡•Å‡§µ‡§® ‡§ï‡•á‡§∏‡§∞‡•Ä ‡§®‡§®‡•ç‡§¶‡§®‡•§' },
            { type: 'chaupai', sanskrit: '‡§§‡•á‡§ú ‡§™‡•ç‡§∞‡§§‡§æ‡§™ ‡§Æ‡§π‡§æ ‡§ú‡§ó ‡§µ‡§®‡•ç‡§¶‡§®‡••', romanized: 'Tej prataap maha jag vandan.', nepali: '‡§§‡•á‡§ú ‡§™‡•ç‡§∞‡§§‡§æ‡§™ ‡§Æ‡§π‡§æ ‡§ú‡§ó ‡§µ‡§®‡•ç‡§¶‡§®‡••' },
            { type: 'chaupai', sanskrit: '‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§µ‡§æ‡§® ‡§ó‡•Å‡§£‡•Ä ‡§Ö‡§§‡§ø ‡§ö‡§æ‡§§‡•Å‡§∞‡•§', romanized: 'Vidyaavaan guni ati chatur.', nepali: '‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§µ‡§æ‡§® ‡§ó‡•Å‡§£‡•Ä ‡§Ö‡§§‡§ø ‡§ö‡§æ‡§§‡•Å‡§∞‡•§' },
            { type: 'chaupai', sanskrit: '‡§∞‡§æ‡§Æ ‡§ï‡§æ‡§ú ‡§ï‡§∞‡§ø‡§¨‡•á ‡§ï‡•ã ‡§Ü‡§§‡•Å‡§∞‡••', romanized: 'Raam kaaj karibe ko aatur.', nepali: '‡§∞‡§æ‡§Æ ‡§ï‡§æ‡§ú ‡§ï‡§∞‡§ø‡§¨‡•á ‡§ï‡•ã ‡§Ü‡§§‡•Å‡§∞‡••' },
            { type: 'chaupai', sanskrit: '‡§™‡•ç‡§∞‡§≠‡•Å ‡§ö‡§∞‡§ø‡§§‡•ç‡§∞ ‡§∏‡•Å‡§®‡§ø‡§¨‡•á ‡§ï‡•ã ‡§∞‡§∏‡§ø‡§Ø‡§æ‡•§', romanized: 'Prabhu charitra sunibe ko rasiyaa.', nepali: '‡§™‡•ç‡§∞‡§≠‡•Å ‡§ö‡§∞‡§ø‡§§‡•ç‡§∞ ‡§∏‡•Å‡§®‡§ø‡§¨‡•á ‡§ï‡•ã ‡§∞‡§∏‡§ø‡§Ø‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§∞‡§æ‡§Æ ‡§≤‡§ñ‡§® ‡§∏‡•Ä‡§§‡§æ ‡§Æ‡§® ‡§¨‡§∏‡§ø‡§Ø‡§æ‡••', romanized: 'Raam Lakhan Sita man basiyaa.', nepali: '‡§∞‡§æ‡§Æ ‡§≤‡§ñ‡§® ‡§∏‡•Ä‡§§‡§æ ‡§Æ‡§® ‡§¨‡§∏‡§ø‡§Ø‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§∏‡•Ç‡§ï‡•ç‡§∑‡•ç‡§Æ ‡§∞‡•Ç‡§™ ‡§ß‡§∞‡§ø ‡§∏‡§ø‡§Ø‡§π‡§ø‡§Ç ‡§¶‡§ø‡§ñ‡§æ‡§µ‡§æ‡•§', romanized: 'Sookshma roop dhari siyahin dikhaavaa.', nepali: '‡§∏‡•Ç‡§ï‡•ç‡§∑‡•ç‡§Æ ‡§∞‡•Ç‡§™ ‡§ß‡§∞‡§ø ‡§∏‡§ø‡§Ø‡§π‡§ø‡§Ç ‡§¶‡§ø‡§ñ‡§æ‡§µ‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§µ‡§ø‡§ï‡§ü ‡§∞‡•Ç‡§™ ‡§ß‡§∞‡§ø ‡§≤‡§ô‡•ç‡§ï ‡§ú‡§∞‡§æ‡§µ‡§æ‡••', romanized: 'Vikat roop dhari Lanka jaraavaa.', nepali: '‡§µ‡§ø‡§ï‡§ü ‡§∞‡•Ç‡§™ ‡§ß‡§∞‡§ø ‡§≤‡§ô‡•ç‡§ï ‡§ú‡§∞‡§æ‡§µ‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§≠‡•Ä‡§Æ ‡§∞‡•Ç‡§™ ‡§ß‡§∞‡§ø ‡§Ö‡§∏‡•Å‡§∞ ‡§∏‡§Å‡§π‡§æ‡§∞‡•á‡•§', romanized: 'Bheem roop dhari asur sanhaare.', nepali: '‡§≠‡•Ä‡§Æ ‡§∞‡•Ç‡§™ ‡§ß‡§∞‡§ø ‡§Ö‡§∏‡•Å‡§∞ ‡§∏‡§Ç‡§π‡§æ‡§∞‡•á‡•§' },
            { type: 'chaupai', sanskrit: '‡§∞‡§æ‡§Æ‡§ö‡§®‡•ç‡§¶‡•ç‡§∞ ‡§ï‡•á ‡§ï‡§æ‡§ú ‡§∏‡§Å‡§µ‡§æ‡§∞‡•á‡••', romanized: 'Raamchandra ke kaaj sanvaare.', nepali: '‡§∞‡§æ‡§Æ‡§ö‡§®‡•ç‡§¶‡•ç‡§∞ ‡§ï‡•á ‡§ï‡§æ‡§ú ‡§∏‡§Å‡§µ‡§æ‡§∞‡•á‡••' },
            { type: 'chaupai', sanskrit: '‡§≤‡§æ‡§Ø ‡§∏‡§û‡•ç‡§ú‡•Ä‡§µ‡§® ‡§≤‡§ñ‡§® ‡§ú‡§ø‡§Ø‡§æ‡§è‡•§', romanized: 'Laaye Sanjeevan Lakhan jiyaaye.', nepali: '‡§≤‡§æ‡§Ø ‡§∏‡§û‡•ç‡§ú‡•Ä‡§µ‡§® ‡§≤‡§ñ‡§® ‡§ú‡§ø‡§Ø‡§æ‡§è‡•§' },
            { type: 'chaupai', sanskrit: '‡§∂‡•ç‡§∞‡•Ä ‡§∞‡§ò‡•Å‡§¨‡•Ä‡§∞ ‡§π‡§∞‡§∑‡§ø ‡§â‡§∞ ‡§≤‡§æ‡§è‡••', romanized: 'Shri Raghuveer harashi ur laaye.', nepali: '‡§∂‡•ç‡§∞‡•Ä ‡§∞‡§ò‡•Å‡§µ‡•Ä‡§∞ ‡§π‡§∞‡§∑‡§ø ‡§â‡§∞ ‡§≤‡§æ‡§è‡••' },
            { type: 'chaupai', sanskrit: '‡§∞‡§ò‡•Å‡§™‡§§‡§ø ‡§ï‡•Ä‡§®‡•ç‡§π‡•Ä ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡§æ‡§à‡•§', romanized: 'Raghupati keenhi bahut badaayi.', nepali: '‡§∞‡§ò‡•Å‡§™‡§§‡§ø ‡§ï‡•Ä‡§®‡•ç‡§π‡•Ä ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§æ‡§à‡•§' },
            { type: 'chaupai', sanskrit: '‡§§‡•Å‡§Æ ‡§Æ‡§Æ ‡§™‡•ç‡§∞‡§ø‡§Ø ‡§≠‡§∞‡§§‡§π‡§ø ‡§∏‡§Æ ‡§≠‡§æ‡§à‡••', romanized: 'Tum mam priya Bharatahi sam bhaayi.', nepali: '‡§§‡•Å‡§Æ ‡§Æ‡§Æ ‡§™‡•ç‡§∞‡§ø‡§Ø ‡§≠‡§∞‡§§‡§π‡§ø ‡§∏‡§Æ ‡§≠‡§æ‡§à‡••' },
            { type: 'chaupai', sanskrit: '‡§∏‡§π‡§∏ ‡§¨‡§¶‡§® ‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•ã ‡§ú‡§∏ ‡§ó‡§æ‡§µ‡•à‡§Ç‡•§', romanized: 'Sahas badan tumharo jas gaawain.', nepali: '‡§∏‡§π‡§∏ ‡§¨‡§¶‡§® ‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•ã ‡§ú‡§∏ ‡§ó‡§æ‡§µ‡•à‡§Ç‡•§' },
            { type: 'chaupai', sanskrit: '‡§Ö‡§∏ ‡§ï‡§π‡§ø ‡§∂‡•ç‡§∞‡•Ä‡§™‡§§‡§ø ‡§ï‡§£‡•ç‡§† ‡§≤‡§ó‡§æ‡§µ‡•à‡§Ç‡••', romanized: 'As kahi Shriipati kanth lagaawain.', nepali: '‡§Ö‡§∏ ‡§ï‡§π‡§ø ‡§∂‡•ç‡§∞‡•Ä‡§™‡§§‡§ø ‡§ï‡§£‡•ç‡§† ‡§≤‡§ó‡§æ‡§µ‡•à‡§Ç‡••' },
            { type: 'chaupai', sanskrit: '‡§∏‡§®‡§ï‡§æ‡§¶‡§ø‡§ï ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§æ‡§¶‡§ø ‡§Æ‡•Å‡§®‡•Ä‡§∏‡§æ‡•§', romanized: 'Sanakaadik Brahmaadi Munisaa.', nepali: '‡§∏‡§®‡§ï‡§æ‡§¶‡§ø‡§ï ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§æ‡§¶‡§ø ‡§Æ‡•Å‡§®‡•Ä‡§∏‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§®‡§æ‡§∞‡§¶ ‡§∏‡§æ‡§∞‡§¶ ‡§∏‡§π‡§ø‡§§ ‡§Ö‡§π‡•Ä‡§∏‡§æ‡••', romanized: 'Naarad Saarad sahit Aheesha.', nepali: '‡§®‡§æ‡§∞‡§¶ ‡§∏‡§æ‡§∞‡§¶ ‡§∏‡§π‡§ø‡§§ ‡§Ö‡§π‡•Ä‡§∏‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§ú‡§Æ ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§¶‡§ø‡§ó‡§™‡§æ‡§≤ ‡§ú‡§π‡§æ‡§Å ‡§§‡•á‡•§', romanized: 'Jam Kuber digpaal jahaan te.', nepali: '‡§ú‡§Æ ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§¶‡§ø‡§ó‡§™‡§æ‡§≤ ‡§ú‡§π‡§æ‡§Å ‡§§‡•á‡•§' },
            { type: 'chaupai', sanskrit: '‡§ï‡§µ‡§ø ‡§ï‡•ã‡§µ‡§ø‡§¶ ‡§ï‡§π‡§ø ‡§∏‡§ï‡•á ‡§ï‡§π‡§æ‡§Å ‡§§‡•á‡••', romanized: 'Kavi kovid kahi sake kahaan te.', nepali: '‡§ï‡§µ‡§ø ‡§ï‡•ã‡§µ‡§ø‡§¶ ‡§ï‡§π‡§ø ‡§∏‡§ï‡•á ‡§ï‡§π‡§æ‡§Å ‡§§‡•á‡••' },
            { type: 'chaupai', sanskrit: '‡§§‡•Å‡§Æ ‡§â‡§™‡§ï‡§æ‡§∞ ‡§∏‡•Å‡§ó‡•ç‡§∞‡•Ä‡§µ‡§π‡§ø‡§Ç ‡§ï‡•Ä‡§®‡•ç‡§π‡§æ‡•§', romanized: 'Tum upkaar Sugreevahim keenhaa.', nepali: '‡§§‡•Å‡§Æ ‡§â‡§™‡§ï‡§æ‡§∞ ‡§∏‡•Å‡§ó‡•ç‡§∞‡•Ä‡§µ‡§π‡§ø‡§Ç ‡§ï‡•Ä‡§®‡•ç‡§π‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§∞‡§æ‡§Æ ‡§Æ‡§ø‡§≤‡§æ‡§Ø ‡§∞‡§æ‡§ú ‡§™‡§¶ ‡§¶‡•Ä‡§®‡•ç‡§π‡§æ‡••', romanized: 'Raam milaaye raaj pad deenhaa.', nepali: '‡§∞‡§æ‡§Æ ‡§Æ‡§ø‡§≤‡§æ‡§Ø ‡§∞‡§æ‡§ú ‡§™‡§¶ ‡§¶‡•Ä‡§®‡•ç‡§π‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•ã ‡§Æ‡§®‡•ç‡§§‡•ç‡§∞ ‡§µ‡§ø‡§≠‡•Ä‡§∑‡§£ ‡§Æ‡§æ‡§®‡§æ‡•§', romanized: 'Tumharo mantra Vibheeshan maanaa.', nepali: '‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•ã ‡§Æ‡§®‡•ç‡§§‡•ç‡§∞ ‡§µ‡§ø‡§≠‡•Ä‡§∑‡§£ ‡§Æ‡§æ‡§®‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§≤‡§ô‡•ç‡§ï‡•á‡§∂‡•ç‡§µ‡§∞ ‡§≠‡§è ‡§∏‡§¨ ‡§ú‡§ó ‡§ú‡§æ‡§®‡§æ‡••', romanized: 'Lankeshwar bhaye sab jag jaanaa.', nepali: '‡§≤‡§ô‡•ç‡§ï‡•á‡§∂‡•ç‡§µ‡§∞ ‡§≠‡§è ‡§∏‡§¨ ‡§ú‡§ó ‡§ú‡§æ‡§®‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§ú‡•Å‡§ó ‡§∏‡§π‡§∏‡•ç‡§∞ ‡§ú‡•ã‡§ú‡§® ‡§™‡§∞ ‡§≠‡§æ‡§®‡•Å‡•§', romanized: 'Jug sahasra yojan par bhaanu.', nepali: '‡§ú‡•Å‡§ó ‡§∏‡§π‡§∏‡•ç‡§§‡•ç‡§∞ ‡§ú‡•ã‡§ú‡§® ‡§™‡§∞ ‡§≠‡§æ‡§®‡•Å‡•§' },
            { type: 'chaupai', sanskrit: '‡§≤‡•Ä‡§≤‡•ç‡§Ø‡•ã ‡§§‡§æ‡§π‡§ø ‡§Æ‡§ß‡•Å‡§∞ ‡§´‡§≤ ‡§ú‡§æ‡§®‡•Å‡••', romanized: 'Leelyo taahi madhur phal jaanu.', nepali: '‡§≤‡•Ä‡§≤‡•ç‡§Ø‡•ã ‡§§‡§æ‡§π‡§ø ‡§Æ‡§ß‡•Å‡§∞ ‡§´‡§≤ ‡§ú‡§æ‡§®‡•Å‡••' },
            { type: 'chaupai', sanskrit: '‡§™‡•ç‡§∞‡§≠‡•Å ‡§Æ‡•Å‡§¶‡•ç‡§∞‡§ø‡§ï‡§æ ‡§Æ‡•á‡§≤‡§ø ‡§Æ‡•Å‡§ñ ‡§Æ‡§æ‡§π‡•Ä‡§Ç‡•§', romanized: 'Prabhu mudrika meli mukh maahin.', nepali: '‡§™‡•ç‡§∞‡§≠‡•Å ‡§Æ‡•Å‡§¶‡•ç‡§∞‡§ø‡§ï‡§æ ‡§Æ‡•á‡§≤‡§ø ‡§Æ‡•Å‡§ñ ‡§Æ‡§æ‡§π‡•Ä‡§Ç‡•§' },
            { type: 'chaupai', sanskrit: '‡§ú‡§≤‡§ß‡§ø ‡§≤‡§æ‡§Å‡§ò‡§ø ‡§ó‡§Ø‡•á ‡§Ö‡§ö‡§∞‡§ú ‡§®‡§æ‡§π‡•Ä‡§Ç‡••', romanized: 'Jaladhi laanghi gaye acharaj naahin.', nepali: '‡§ú‡§≤‡§ß‡§ø ‡§≤‡§æ‡§Å‡§ò‡§ø ‡§ó‡§Ø‡•á ‡§Ö‡§ö‡§∞‡§ú ‡§®‡§æ‡§π‡•Ä‡§Ç‡••' },
            { type: 'chaupai', sanskrit: '‡§¶‡•Å‡§∞‡•ç‡§ó‡§Æ ‡§ï‡§æ‡§ú ‡§ú‡§ó‡§§ ‡§ï‡•á ‡§ú‡•á‡§§‡•á‡•§', romanized: 'Durgam kaaj jagat ke jete.', nepali: '‡§¶‡•Å‡§∞‡•ç‡§ó‡§Æ ‡§ï‡§æ‡§ú ‡§ú‡§ó‡§§ ‡§ï‡•á ‡§ú‡•á‡§§‡•á‡•§' },
            { type: 'chaupai', sanskrit: '‡§∏‡•Å‡§ó‡§Æ ‡§Ö‡§®‡•Å‡§ó‡•ç‡§∞‡§π ‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•á ‡§§‡•á‡§§‡•á‡••', romanized: 'Sugam anugrah tumhare tete.', nepali: '‡§∏‡•Å‡§ó‡§Æ ‡§Ö‡§®‡•Å‡§ó‡•ç‡§∞‡§π ‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•á ‡§§‡•á‡§§‡•á‡••' },
            { type: 'chaupai', sanskrit: '‡§∞‡§æ‡§Æ ‡§¶‡•Å‡§Ü‡§∞‡•á ‡§§‡•Å‡§Æ ‡§∞‡§ñ‡§µ‡§æ‡§∞‡•á‡•§', romanized: 'Raam duare tum rakhwaare.', nepali: '‡§∞‡§æ‡§Æ ‡§¶‡•Å‡§Ü‡§∞‡•á ‡§§‡•Å‡§Æ ‡§∞‡§ñ‡§µ‡§æ‡§∞‡•á‡•§' },
            { type: 'chaupai', sanskrit: '‡§π‡•ã‡§§ ‡§® ‡§Ü‡§ú‡•ç‡§û‡§æ ‡§¨‡§ø‡§®‡•Å ‡§™‡•à‡§∏‡§æ‡§∞‡•á‡••', romanized: 'Hot na aagyaa binu paisaare.', nepali: '‡§π‡•ã‡§§ ‡§® ‡§Ü‡§ú‡•ç‡§û‡§æ ‡§¨‡§ø‡§®‡•Å ‡§™‡•à‡§∏‡§æ‡§∞‡•á‡••' },
            { type: 'chaupai', sanskrit: '‡§∏‡§¨ ‡§∏‡•Å‡§ñ ‡§≤‡§π‡•à ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•Ä ‡§∏‡§∞‡§®‡§æ‡•§', romanized: 'Sab sukh lahai tumhaari sarnaa.', nepali: '‡§∏‡§¨ ‡§∏‡•Å‡§ñ ‡§≤‡§π‡•à ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•Ä ‡§∏‡§∞‡§®‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§§‡•Å‡§Æ ‡§∞‡§ï‡•ç‡§∑‡§ï ‡§ï‡§æ‡§π‡•Ç ‡§ï‡•ã ‡§°‡§∞ ‡§®‡§æ‡••', romanized: 'Tum rakshak kaahu ko dar naa.', nepali: '‡§§‡•Å‡§Æ ‡§∞‡§ï‡•ç‡§∑‡§ï ‡§ï‡§æ‡§π‡•Ç ‡§ï‡•ã ‡§°‡§∞ ‡§®‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§Ü‡§™‡§® ‡§§‡•á‡§ú ‡§∏‡§Æ‡•ç‡§π‡§æ‡§∞‡•ã ‡§Ü‡§™‡•à‡•§', romanized: 'Aapan tej sanhaaro aapai.', nepali: '‡§Ü‡§™‡§® ‡§§‡•á‡§ú ‡§∏‡§Æ‡•ç‡§π‡§æ‡§∞‡•ã ‡§Ü‡§™‡•à‡•§' },
            { type: 'chaupai', sanskrit: '‡§§‡•Ä‡§®‡•ã‡§Ç ‡§≤‡•ã‡§ï ‡§π‡§æ‡§Å‡§ï ‡§§‡•á‡§Ç ‡§ï‡§æ‡§Å‡§™‡•à‡••', romanized: 'Teeno lok haank ten kaanpai.', nepali: '‡§§‡•Ä‡§®‡•ã‡§Ç ‡§≤‡•ã‡§ï ‡§π‡§æ‡§Å‡§ï ‡§§‡•á‡§Ç ‡§ï‡§æ‡§Å‡§™‡•à‡••' },
            { type: 'chaupai', sanskrit: '‡§≠‡•Ç‡§§ ‡§™‡§ø‡§∂‡§æ‡§ö ‡§®‡§ø‡§ï‡§ü ‡§®‡§π‡§ø‡§Ç ‡§Ü‡§µ‡•à‡•§', romanized: 'Bhoot pishaach nikat nahin aawai.', nepali: '‡§≠‡•Ç‡§§ ‡§™‡§ø‡§∂‡§æ‡§ö ‡§®‡§ø‡§ï‡§ü ‡§®‡§π‡§ø‡§Ç ‡§Ü‡§µ‡•à‡•§' },
            { type: 'chaupai', sanskrit: '‡§Æ‡§π‡§æ‡§µ‡•Ä‡§∞ ‡§ú‡§¨ ‡§®‡§æ‡§Æ ‡§∏‡•Å‡§®‡§æ‡§µ‡•à‡••', romanized: 'Mahaavir jab naam sunaawai.', nepali: '‡§Æ‡§π‡§æ‡§µ‡•Ä‡§∞ ‡§ú‡§¨ ‡§®‡§æ‡§Æ ‡§∏‡•Å‡§®‡§æ‡§µ‡•à‡••' },
            { type: 'chaupai', sanskrit: '‡§®‡§æ‡§∏‡•à ‡§∞‡•ã‡§ó ‡§π‡§∞‡•à ‡§∏‡§¨ ‡§™‡•Ä‡§∞‡§æ‡•§', romanized: 'Naasai rog harai sab peeraa.', nepali: '‡§®‡§æ‡§∏‡•à ‡§∞‡•ã‡§ó ‡§π‡§∞‡•à ‡§∏‡§¨ ‡§™‡•Ä‡§∞‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§ú‡§™‡§§ ‡§®‡§ø‡§∞‡§®‡•ç‡§§‡§∞ ‡§π‡§®‡•Å‡§Æ‡§§ ‡§¨‡•Ä‡§∞‡§æ‡••', romanized: 'Japat nirantar Hanumat beeraa.', nepali: '‡§ú‡§™‡§§ ‡§®‡§ø‡§∞‡§®‡•ç‡§§‡§∞ ‡§π‡§®‡•Å‡§Æ‡§§ ‡§¨‡•Ä‡§∞‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§∏‡§Ç‡§ï‡§ü ‡§§‡•á‡§Ç ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§õ‡•Å‡§°‡§º‡§æ‡§µ‡•à‡•§', romanized: 'Sankat ten Hanuman chhudaawai.', nepali: '‡§∏‡§ô‡•ç‡§ï‡§ü ‡§§‡•á‡§Ç ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§õ‡•Å‡•ú‡§æ‡§µ‡•à‡•§' },
            { type: 'chaupai', sanskrit: '‡§Æ‡§® ‡§ï‡•ç‡§∞‡§Æ ‡§µ‡§ö‡§® ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ú‡•ã ‡§≤‡§æ‡§µ‡•à‡••', romanized: 'Man kram vachan dhyaan jo laawai.', nepali: '‡§Æ‡§® ‡§ï‡•ç‡§∞‡§Æ ‡§µ‡§ö‡§® ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ú‡•ã ‡§≤‡§æ‡§µ‡•à‡••' },
            { type: 'chaupai', sanskrit: '‡§∏‡§¨ ‡§™‡§∞ ‡§∞‡§æ‡§Æ ‡§§‡§™‡§∏‡•ç‡§µ‡•Ä ‡§∞‡§æ‡§ú‡§æ‡•§', romanized: 'Sab par Raam tapasvee raajaa.', nepali: '‡§∏‡§¨ ‡§™‡§∞ ‡§∞‡§æ‡§Æ ‡§§‡§™‡§∏‡•ç‡§µ‡•Ä ‡§∞‡§æ‡§ú‡§æ.' },
            { type: 'chaupai', sanskrit: '‡§§‡§ø‡§® ‡§ï‡•á ‡§ï‡§æ‡§ú ‡§∏‡§ï‡§≤ ‡§§‡•Å‡§Æ ‡§∏‡§æ‡§ú‡§æ‡••', romanized: 'Tin ke kaaj sakal tum saajaa.', nepali: '‡§§‡§ø‡§® ‡§ï‡•á ‡§ï‡§æ‡§ú ‡§∏‡§ï‡§≤ ‡§§‡•Å‡§Æ ‡§∏‡§æ‡§ú‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§î‡§∞ ‡§Æ‡§®‡•ã‡§∞‡§• ‡§ú‡•ã ‡§ï‡•ã‡§à ‡§≤‡§æ‡§µ‡•à‡•§', romanized: 'Aur manorath jo koi laawai.', nepali: '‡§î‡§∞ ‡§Æ‡§®‡•ã‡§∞‡§• ‡§ú‡•ã ‡§ï‡•ã‡§à ‡§≤‡§æ‡§µ‡•à‡•§' },
            { type: 'chaupai', sanskrit: '‡§∏‡•ã‡§á ‡§Ö‡§Æ‡§ø‡§§ ‡§ú‡•Ä‡§µ‡§® ‡§´‡§≤ ‡§™‡§æ‡§µ‡•à‡••', romanized: 'Soi amit jeevan phal paawai.', nepali: '‡§∏‡•ã‡§á ‡§Ö‡§Æ‡§ø‡§§ ‡§ú‡•Ä‡§µ‡§® ‡§´‡§≤ ‡§™‡§æ‡§µ‡•à‡••' },
            { type: 'chaupai', sanskrit: '‡§ö‡§æ‡§∞‡•ã‡§Ç ‡§ú‡•Å‡§ó ‡§™‡§∞‡§§‡§æ‡§™ ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡§æ‡•§', romanized: 'Chaaro jug partaap tumhaaraa.', nepali: '‡§ö‡§æ‡§∞‡•ã‡§Ç ‡§ú‡•Å‡§ó ‡§™‡§∞‡§§‡§æ‡§™ ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§π‡•à ‡§™‡§∞‡§∏‡§ø‡§¶‡•ç‡§ß ‡§ú‡§ó‡§§ ‡§â‡§ú‡§ø‡§Ø‡§æ‡§∞‡§æ‡••', romanized: 'Hai parasiddh jagat ujiyaaraa.', nepali: '‡§π‡•à ‡§™‡§∞‡§∏‡§ø‡§¶‡•ç‡§ß ‡§ú‡§ó‡§§ ‡§â‡§ú‡§ø‡§Ø‡§æ‡§∞‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§∏‡§æ‡§ß‡•Å ‡§∏‡§®‡•ç‡§§ ‡§ï‡•á ‡§§‡•Å‡§Æ ‡§∞‡§ñ‡§µ‡§æ‡§∞‡•á‡•§', romanized: 'Saadhu sant ke tum rakhwaare.', nepali: '‡§∏‡§æ‡§ß‡•Å ‡§∏‡§®‡•ç‡§§ ‡§ï‡•á ‡§§‡•Å‡§Æ ‡§∞‡§ñ‡§µ‡§æ‡§∞‡•á‡•§' },
            { type: 'chaupai', sanskrit: '‡§Ö‡§∏‡•Å‡§∞ ‡§®‡§ø‡§ï‡§®‡•ç‡§¶‡§® ‡§∞‡§æ‡§Æ ‡§¶‡•Å‡§≤‡§æ‡§∞‡•á‡••', romanized: 'Asur nikandan Raam dulaare.', nepali: '‡§Ö‡§∏‡•Å‡§∞ ‡§®‡§ø‡§ï‡§®‡•ç‡§¶‡§® ‡§∞‡§æ‡§Æ ‡§¶‡•Å‡§≤‡§æ‡§∞‡•á‡••' },
            { type: 'chaupai', sanskrit: '‡§Ö‡§∑‡•ç‡§ü ‡§∏‡§ø‡§¶‡•ç‡§ß‡§ø ‡§®‡•å ‡§®‡§ø‡§ß‡§ø ‡§ï‡•á ‡§¶‡§æ‡§§‡§æ‡•§', romanized: 'Asht siddhi nau nidhi ke daataa.', nepali: '‡§Ö‡§∑‡•ç‡§ü ‡§∏‡§ø‡§¶‡•ç‡§ß‡§ø ‡§®‡•å ‡§®‡§ø‡§ß‡§ø ‡§ï‡•á ‡§¶‡§æ‡§§‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§Ö‡§∏ ‡§¨‡§∞ ‡§¶‡•Ä‡§® ‡§ú‡§æ‡§®‡§ï‡•Ä ‡§Æ‡§æ‡§§‡§æ‡••', romanized: 'As var deen Jaanakee maataa.', nepali: '‡§Ö‡§∏ ‡§µ‡§∞ ‡§¶‡•Ä‡§® ‡§ú‡§æ‡§®‡§ï‡•Ä ‡§Æ‡§æ‡§§‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§∞‡§æ‡§Æ ‡§∞‡§∏‡§æ‡§Ø‡§® ‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•á ‡§™‡§æ‡§∏‡§æ‡•§', romanized: 'Raam rasaayan tumhare paasaa.', nepali: '‡§∞‡§æ‡§Æ ‡§∞‡§∏‡§æ‡§Ø‡§® ‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•á ‡§™‡§æ‡§∏‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§∏‡§¶‡§æ ‡§∞‡§π‡•ã ‡§∞‡§ò‡•Å‡§™‡§§‡§ø ‡§ï‡•á ‡§¶‡§æ‡§∏‡§æ‡••', romanized: 'Sadaa raho Raghupati ke daasaa.', nepali: '‡§∏‡§¶‡§æ ‡§∞‡§π‡•ã ‡§∞‡§ò‡•Å‡§™‡§§‡§ø ‡§ï‡•á ‡§¶‡§æ‡§∏‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•á ‡§≠‡§ú‡§® ‡§∞‡§æ‡§Æ ‡§ï‡•ã ‡§™‡§æ‡§µ‡•à‡•§', romanized: 'Tumhare bhajan Raam ko paawai.', nepali: '‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•á ‡§≠‡§ú‡§® ‡§∞‡§æ‡§Æ ‡§ï‡•ã ‡§™‡§æ‡§µ‡•à‡•§' },
            { type: 'chaupai', sanskrit: '‡§ú‡§®‡§Æ ‡§ú‡§®‡§Æ ‡§ï‡•á ‡§¶‡•Å‡§ñ ‡§¨‡§ø‡§∏‡§∞‡§æ‡§µ‡•à‡••', romanized: 'Janam janam ke dukh bisraawai.', nepali: '‡§ú‡§®‡§Æ ‡§ú‡§®‡§Æ ‡§ï‡•á ‡§¶‡•Å‡§ñ ‡§¨‡§ø‡§∏‡§∞‡§æ‡§µ‡•à‡••' },
            { type: 'chaupai', sanskrit: '‡§Ö‡§®‡•ç‡§§ ‡§ï‡§æ‡§≤ ‡§∞‡§ò‡•Å‡§¨‡§∞ ‡§™‡•Å‡§∞ ‡§ú‡§æ‡§à‡•§', romanized: 'Ant kaal Raghubar pur jaayi.', nepali: '‡§Ö‡§®‡•ç‡§§ ‡§ï‡§æ‡§≤ ‡§∞‡§ò‡•Å‡§¨‡§∞ ‡§™‡•Å‡§∞ ‡§ú‡§æ‡§à‡•§' },
            { type: 'chaupai', sanskrit: '‡§ú‡§π‡§æ‡§Å ‡§ú‡§®‡•ç‡§Æ ‡§π‡§∞‡§ø ‡§≠‡§ï‡•ç‡§§ ‡§ï‡§π‡§æ‡§à‡••', romanized: 'Jahaan janma Hari bhakt kahaayi.', nepali: '‡§ú‡§π‡§æ‡§Å ‡§ú‡§®‡•ç‡§Æ ‡§π‡§∞‡§ø ‡§≠‡§ï‡•ç‡§§ ‡§ï‡§π‡§æ‡§à‡••' },
            { type: 'chaupai', sanskrit: '‡§î‡§∞ ‡§¶‡•á‡§µ‡§§‡§æ ‡§ö‡§ø‡§§‡•ç‡§§ ‡§® ‡§ß‡§∞‡§à‡•§', romanized: 'Aur devataa chitt na dharai.', nepali: '‡§î‡§∞ ‡§¶‡•á‡§µ‡§§‡§æ ‡§ö‡§ø‡§§‡•ç‡§§ ‡§® ‡§ß‡§∞‡§à‡•§' },
            { type: 'chaupai', sanskrit: '‡§π‡§®‡•Å‡§Æ‡§§ ‡§∏‡•á‡§á ‡§∏‡§∞‡•ç‡§µ ‡§∏‡•Å‡§ñ ‡§ï‡§∞‡§à‡••', romanized: 'Hanumat sei sarv sukh karai.', nepali: '‡§π‡§®‡•Å‡§Æ‡§§ ‡§∏‡•á‡§á ‡§∏‡§∞‡•ç‡§µ ‡§∏‡•Å‡§ñ ‡§ï‡§∞‡§à‡••' },
            { type: 'chaupai', sanskrit: '‡§∏‡§Ç‡§ï‡§ü ‡§ï‡§ü‡•à ‡§Æ‡§ø‡§ü‡•à ‡§∏‡§¨ ‡§™‡•Ä‡§∞‡§æ‡•§', romanized: 'Sankat katai mitai sab peeraa.', nepali: '‡§∏‡§Ç‡§ï‡§ü ‡§ï‡§ü‡•à ‡§Æ‡§ø‡§ü‡•à ‡§∏‡§¨ ‡§™‡•Ä‡§∞‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§ú‡•ã ‡§∏‡•Å‡§Æ‡§ø‡§∞‡•à ‡§π‡§®‡•Å‡§Æ‡§§ ‡§¨‡§≤‡§¨‡•Ä‡§∞‡§æ‡••', romanized: 'Jo sumirai Hanumat balbeeraa.', nepali: '‡§ú‡•ã ‡§∏‡•Å‡§Æ‡§ø‡§∞‡•à ‡§π‡§®‡•Å‡§Æ‡§§ ‡§¨‡§≤‡§¨‡•Ä‡§∞‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§ú‡§Ø ‡§ú‡§Ø ‡§ú‡§Ø ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§ó‡•ã‡§∏‡§æ‡§à‡§Ç‡•§', romanized: 'Jai jai jai Hanuman Gosain.', nepali: '‡§ú‡§Ø ‡§ú‡§Ø ‡§ú‡§Ø ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§ó‡•ã‡§∏‡§æ‡§à‡§Ç‡•§' },
            { type: 'chaupai', sanskrit: '‡§ï‡•É‡§™‡§æ ‡§ï‡§∞‡§π‡•Å ‡§ó‡•Å‡§∞‡•Å‡§¶‡•á‡§µ ‡§ï‡•Ä ‡§®‡§æ‡§à‡§Ç‡••', romanized: 'Kripaa karahu Gurudev ki naain.', nepali: '‡§ï‡•É‡§™‡§æ ‡§ï‡§∞‡§π‡•Å ‡§ó‡•Å‡§∞‡•Å‡§¶‡•á‡§µ ‡§ï‡•Ä ‡§®‡§æ‡§à‡§Ç‡••' },
            { type: 'chaupai', sanskrit: '‡§ú‡•ã ‡§∏‡§§ ‡§¨‡§æ‡§∞ ‡§™‡§æ‡§† ‡§ï‡§∞ ‡§ï‡•ã‡§à‡•§', romanized: 'Jo sat baar paath kar koi.', nepali: '‡§ú‡•ã ‡§∏‡§§ ‡§¨‡§æ‡§∞ ‡§™‡§æ‡§† ‡§ï‡§∞ ‡§ï‡•ã‡§à‡•§' },
            { type: 'chaupai', sanskrit: '‡§õ‡•Ç‡§ü‡§π‡§ø ‡§¨‡§®‡•ç‡§¶‡§ø ‡§Æ‡§π‡§æ ‡§∏‡•Å‡§ñ ‡§π‡•ã‡§à‡••', romanized: 'Chhootahi bandi mahaa sukh hoi.', nepali: '‡§õ‡•Ç‡§ü‡§π‡§ø ‡§¨‡§®‡•ç‡§¶‡§ø ‡§Æ‡§π‡§æ ‡§∏‡•Å‡§ñ ‡§π‡•ã‡§à‡••' },
            { type: 'chaupai', sanskrit: '‡§ú‡•ã ‡§Ø‡§π ‡§™‡§¢‡§º‡•à ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§ö‡§æ‡§≤‡•Ä‡§∏‡§æ‡•§', romanized: 'Jo yah padhai Hanuman Chaaleesaa.', nepali: '‡§ú‡•ã ‡§Ø‡§π ‡§™‡§¢‡§º‡•à ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§ö‡§æ‡§≤‡•Ä‡§∏‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§π‡•ã‡§Ø ‡§∏‡§ø‡§¶‡•ç‡§ß‡§ø ‡§∏‡§æ‡§ñ‡•Ä ‡§ó‡•å‡§∞‡•Ä‡§∏‡§æ‡••', romanized: 'Hoy siddhi saakhi Gaureesaa.', nepali: '‡§π‡•ã‡§Ø ‡§∏‡§ø‡§¶‡•ç‡§ß‡§ø ‡§∏‡§æ‡§ñ‡•Ä ‡§ó‡•å‡§∞‡•Ä‡§∏‡§æ‡••' },
            { type: 'chaupai', sanskrit: '‡§§‡•Å‡§≤‡§∏‡•Ä‡§¶‡§æ‡§∏ ‡§∏‡§¶‡§æ ‡§π‡§∞‡§ø ‡§ö‡•á‡§∞‡§æ‡•§', romanized: 'Tulaseedaas sadaa Hari cheraa.', nepali: '‡§§‡•Å‡§≤‡§∏‡•Ä‡§¶‡§æ‡§∏ ‡§∏‡§¶‡§æ ‡§π‡§∞‡§ø ‡§ö‡•á‡§∞‡§æ‡•§' },
            { type: 'chaupai', sanskrit: '‡§ï‡•Ä‡§ú‡•à ‡§®‡§æ‡§• ‡§π‡•É‡§¶‡§Ø ‡§Æ‡§π‡§Å ‡§°‡•á‡§∞‡§æ‡••', romanized: 'Keejai naath hriday mah deraa.', nepali: '‡§ï‡•Ä‡§ú‡•à ‡§®‡§æ‡§• ‡§π‡•É‡§¶‡§Ø ‡§Æ‡§π‡§Å ‡§°‡•á‡§∞‡§æ‡••' },

            // Closing Doha
            { type: 'doha', sanskrit: '‡§™‡§µ‡§® ‡§§‡§®‡§Ø ‡§∏‡§ô‡•ç‡§ï‡§ü ‡§π‡§∞‡§®, ‡§Æ‡§Ç‡§ó‡§≤ ‡§Æ‡•Ç‡§∞‡§§‡§ø ‡§∞‡•Ç‡§™‡•§ ‡§∞‡§æ‡§Æ ‡§≤‡§ñ‡§® ‡§∏‡•Ä‡§§‡§æ ‡§∏‡§π‡§ø‡§§, ‡§π‡•É‡§¶‡§Ø ‡§¨‡§∏‡§π‡•Å ‡§∏‡•Å‡§∞ ‡§≠‡•Ç‡§™‡••', romanized: 'Pavan tanay sankat haran, mangal moorati roop. Raam Lakhan Sita sahit, hriday basahu sur bhoop.', nepali: '‡§™‡§µ‡§® ‡§§‡§®‡§Ø ‡§∏‡§Ç‡§ï‡§ü ‡§π‡§∞‡§£, ‡§Æ‡§ô‡•ç‡§ó‡§≤ ‡§Æ‡•Ç‡§∞‡§§‡§ø ‡§∞‡•Ç‡§™‡•§ ‡§∞‡§æ‡§Æ ‡§≤‡§ñ‡§® ‡§∏‡•Ä‡§§‡§æ ‡§∏‡§π‡§ø‡§§, ‡§π‡•É‡§¶‡§Ø ‡§¨‡§∏‡§π‡•Å ‡§∏‡•Å‡§∞ ‡§≠‡•Ç‡§™‡••' }
        ];

        document.addEventListener('DOMContentLoaded', () => {
            // DOM Elements
            const startScreen = document.getElementById('start-screen');
            const startButton = document.getElementById('start-button');
            const challengeArea = document.getElementById('challenge-area');
            const targetTextElement = document.getElementById('target-text');
            const sanskritHintElement = document.getElementById('sanskrit-hint');
            const nepaliHintElement = document.getElementById('nepali-hint');
            const userInput = document.getElementById('user-input'); // The actual text input
            const typedDisplay = document.getElementById('typed-display'); // The visual display
            const typingWrapper = document.getElementById('typing-wrapper'); // Wrapper for focus
            const feedbackMessage = document.getElementById('feedback-message');
            const nextButton = document.getElementById('next-button');
            const progressDisplay = document.getElementById('progress-display');
            
            const statsBar = document.getElementById('stats-bar');
            const wpmDisplay = document.getElementById('wpm-display');
            const accuracyDisplay = document.getElementById('accuracy-display');
            const scoreDisplay = document.getElementById('score-display');
            
            // New Selector Element
            const lineSelector = document.getElementById('line-selector');

            const lineTypeHeader = document.getElementById('line-type-header');
            
            const toggleFullTextButton = document.getElementById('toggle-full-text');
            const fullTextDisplay = document.getElementById('full-text-display');
            
            // Game State
            let currentLineIndex = 0;
            let rawScore = 0; 
            const totalLines = chalisaData.length; // Corrected total lines (83 elements)

            // New Stats State
            let startTime = null;
            let totalTypedCharacters = 0;
            let totalErrors = 0;

            // --- Helper Functions for Line Selection ---

            /**
             * Generates a descriptive label for the line selector option.
             */
            function getLineLabel(index) {
                if (index === 0) return 'Invocation - Line 1 (Doha)';
                if (index === 1) return 'Invocation - Line 2 (Doha)';

                if (index >= 2 && index <= 81) {
                    // Chaupai lines (Indices 2 through 81)
                    const chaupaiIndex = index - 2;
                    const stanzaNumber = Math.floor(chaupaiIndex / 2) + 1;
                    const lineInStanza = (chaupaiIndex % 2) + 1;
                    return `Chaupai ${stanzaNumber} - Line ${lineInStanza}`;
                }

                if (index === 82) return 'Closing Doha';
                
                return `Line ${index + 1}`;
            }

            /**
             * Populates the line selection dropdown.
             */
            function populateLineSelector() {
                lineSelector.innerHTML = '';
                for (let i = 0; i < totalLines; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = getLineLabel(i);
                    lineSelector.appendChild(option);
                }
            }

            /**
             * Jumps the game state to the selected line index from the dropdown.
             */
            function jumpToLine(event) {
                const newIndex = parseInt(event.target.value, 10);
                
                // Reset input
                userInput.value = '';
                
                // Update the current line index
                currentLineIndex = newIndex;
                
                // If the challenge is active, render the new line and reset session stats
                if (!challengeArea.classList.contains('hidden')) {
                    renderCurrentLine();
                    
                    // Reset session stats (WPM, Accuracy) since the user intentionally jumped.
                    startTime = Date.now();
                    totalTypedCharacters = 0;
                    totalErrors = 0;
                    rawScore = 0;
                    wpmDisplay.textContent = '0';
                    accuracyDisplay.textContent = '100%';
                    scoreDisplay.textContent = '0';
                }
            }

            // --- Core Game Functions ---

            /**
             * Renders the current line for the user to type.
             */
            function renderCurrentLine() {
                if (currentLineIndex >= totalLines) {
                    finishGame();
                    return;
                }

                const line = chalisaData[currentLineIndex];
                
                // Update UI elements
                targetTextElement.textContent = line.romanized;
                sanskritHintElement.textContent = line.sanskrit;
                nepaliHintElement.textContent = line.nepali;

                // Update line type header
                let typeText = getLineLabel(currentLineIndex);
                lineTypeHeader.textContent = typeText;

                // Reset input, display, and focus
                userInput.value = '';
                // Keep input enabled
                userInput.disabled = false; 
                typingWrapper.focus(); // Set focus to the visual area
                userInput.focus(); // Set focus to the hidden input
                checkInput(); // Render initial untyped text

                feedbackMessage.textContent = '';
                feedbackMessage.className = 'text-center font-bold h-6';
                nextButton.disabled = true;

                // Update progress and selector
                progressDisplay.textContent = `Line ${currentLineIndex + 1} / ${totalLines}`;
                lineSelector.value = currentLineIndex; // Keep selector synced
                scoreDisplay.textContent = rawScore;
            }

            /**
             * Calculates WPM (Words Per Minute) based on time elapsed and characters typed.
             */
            function calculateWPM() {
                if (!startTime) return 0;
                const elapsedTimeSeconds = (Date.now() - startTime) / 1000;
                if (elapsedTimeSeconds === 0) return 0;
                
                // Calculate gross characters typed so far (current line + finished lines)
                const grossTypedChars = userInput.value.length + totalTypedCharacters;
                
                const minutes = elapsedTimeSeconds / 60;
                // Standard word length is 5 characters
                return Math.round((grossTypedChars / 5) / minutes);
            }

            /**
             * Calculates Accuracy based on total correct vs total typed characters.
             */
            function calculateAccuracy(inputLength, errors) {
                if (inputLength === 0) return 100;
                const correctChars = inputLength - errors;
                return Math.max(0, Math.round((correctChars / inputLength) * 100)); // Ensure it doesn't go below 0%
            }


            /**
             * Generates the color-coded HTML display based on user input.
             */
            function checkInput() {
                const target = chalisaData[currentLineIndex].romanized;
                const input = userInput.value;
                let displayHtml = '';
                let errorFound = false;
                let fullMatch = true;
                let lineErrors = 0; // Errors specific to the current line input
                
                // 1. Iterate through the target text character by character
                for (let i = 0; i < target.length; i++) {
                    const targetChar = target[i];
                    const inputChar = input[i];
                    let charClass = 'untyped';

                    if (i < input.length) {
                        // User has typed this character
                        if (inputChar === targetChar) {
                            charClass = 'correct';
                        } else {
                            charClass = 'incorrect';
                            errorFound = true;
                            lineErrors++; // Count error
                            fullMatch = false;
                        }
                    } else {
                        // Character is yet to be typed
                        if (i === input.length && !errorFound) {
                            charClass = 'cursor'; // Apply cursor style to the next character
                        } else {
                            fullMatch = false;
                        }
                    }
                    
                    // Render the character inside a span with the determined class
                    const charToDisplay = targetChar === ' ' ? ' ' : targetChar; 
                    displayHtml += `<span class="char ${charClass}">${charToDisplay}</span>`;
                }
                
                // 2. Handle trailing incorrect characters (if user types too much)
                if (input.length > target.length) {
                    errorFound = true;
                    fullMatch = false;
                    for (let i = target.length; i < input.length; i++) {
                        const inputChar = input[i];
                        lineErrors++; // Count error for extra characters
                        displayHtml += `<span class="char incorrect">${inputChar}</span>`;
                    }
                }
                
                // 3. Update the visual display
                typedDisplay.innerHTML = displayHtml;
                
                // 4. Update the Stats Bar in real-time
                const currentTotalTyped = input.length + totalTypedCharacters;
                const currentTotalErrors = lineErrors + totalErrors;

                const currentWPM = calculateWPM();
                const currentAccuracy = calculateAccuracy(currentTotalTyped, currentTotalErrors);

                wpmDisplay.textContent = currentWPM;
                accuracyDisplay.textContent = `${currentAccuracy}%`;

                
                // 5. Update the feedback message and game state
                if (fullMatch && input.length === target.length && !errorFound) {
                    // Success!
                    rawScore += 10;
                    totalTypedCharacters += input.length; // Finalize characters for this line
                    totalErrors += lineErrors; // Finalize errors for this line (should be 0 here, but for safety)

                    feedbackMessage.textContent = '‚úÖ Correct! Press Enter or Next to continue.';
                    feedbackMessage.classList.add('feedback-correct');
                    feedbackMessage.classList.remove('feedback-error');
                    
                    // Keep input ENABLED so it can capture the Enter keypress.
                    nextButton.disabled = false;
                } else if (errorFound) {
                    // Typing error
                    feedbackMessage.textContent = '‚ùå Mistake! Check the highlighted character(s).';
                    feedbackMessage.classList.add('feedback-error');
                    feedbackMessage.classList.remove('feedback-correct');
                    nextButton.disabled = true;
                } else {
                    // Typing in progress
                    feedbackMessage.textContent = 'Typing...';
                    feedbackMessage.className = 'text-center font-bold h-6';
                    nextButton.disabled = true;
                }
                
                scoreDisplay.textContent = rawScore; // Update the simple score
                
                // Ensure the input field remains focused for seamless typing
                userInput.focus();
            }
            
            /**
             * Moves to the next line of the challenge.
             */
            function nextLine() {
                currentLineIndex++;
                renderCurrentLine();
            }

            /**
             * Starts the game, hiding the welcome screen.
             */
            function startGame() {
                startScreen.classList.add('hidden');
                challengeArea.classList.remove('hidden');
                statsBar.classList.remove('hidden'); // Show stats bar

                // Set currentLineIndex based on the selector value when starting
                currentLineIndex = parseInt(lineSelector.value, 10); 
                
                // Reset stats for a new game
                startTime = Date.now();
                totalTypedCharacters = 0;
                totalErrors = 0;
                rawScore = 0;

                // Reset WPM/Accuracy displays to 0 initially
                wpmDisplay.textContent = '0';
                accuracyDisplay.textContent = '100%';
                
                renderCurrentLine();
            }

            /**
             * Ends the game and displays the final score.
             */
            function finishGame() {
                challengeArea.classList.add('hidden');
                statsBar.classList.add('hidden'); // Hide stats bar
                
                const finalWPM = calculateWPM();
                const finalAccuracy = calculateAccuracy(totalTypedCharacters, totalErrors);

                startScreen.classList.remove('hidden');
                startScreen.innerHTML = `
                    <h2 class="text-3xl font-bold text-red-700 mb-4">Challenge Complete! üôè</h2>
                    <p class="text-xl mb-4">You have successfully typed the entire Hanuman Chalisa!</p>
                    <div class="flex flex-col space-y-2 mt-8 mb-8">
                        <p class="text-2xl font-extrabold text-green-700">Final WPM: ${finalWPM}</p>
                        <p class="text-xl font-bold text-amber-700">Final Accuracy: ${finalAccuracy}%</p>
                        <p class="text-lg font-semibold text-red-700">Total Score: ${rawScore}</p>
                    </div>
                    <p class="text-sm mt-6 mb-4 opacity-75">Your dedication is admirable. Click below to start over.</p>
                    <button id="restart-button" class="px-8 py-3 bg-red-700 text-white font-bold rounded-full shadow-xl transition duration-200 transform hover:scale-105 active:scale-100 focus:outline-none">
                        Restart Challenge
                    </button>
                `;
                document.getElementById('restart-button').addEventListener('click', () => {
                    currentLineIndex = 0;
                    rawScore = 0;
                    totalTypedCharacters = 0;
                    totalErrors = 0;
                    
                    // Re-initialize start screen and start the game
                    startScreen.innerHTML = originalStartScreenHTML;
                    // Need to re-attach the listener to the newly created button
                    document.getElementById('start-button').addEventListener('click', startGame); 
                    
                    // Call populate to ensure selector is loaded again if needed, and reset value
                    populateLineSelector();
                    lineSelector.value = 0;
                    
                    // Ensure the initial progress text reflects the starting state
                    progressDisplay.textContent = `Line 0 / ${totalLines}`; 
                });
            }

            // --- Full Text View Functions ---

            function renderFullChalisa() {
                const linesHtml = [];
                let stanzaCounter = 0;
                
                linesHtml.push(`
                    <div class="language-grid font-bold text-center border-b-2 border-amber-700/50 pb-2 mb-4 hidden md:grid text-lg">
                        <div class="text-red-700">Sanskrit (‡§¶‡•á‡§µ‡§®‡§æ‡§ó‡§∞‡•Ä)</div>
                        <div class="text-amber-700/80">Romanized (Phonetically Correct Typing)</div>
                        <div class="text-red-700">Nepali (‡§®‡•á‡§™‡§æ‡§≤‡•Ä)</div>
                    </div>
                `);

                chalisaData.forEach((line, index) => {
                    let stanzaLabel = '';
                    let className = '';

                    if (line.type === 'chaupai') {
                        if (index >= 2 && (index - 2) % 2 === 0) {
                            stanzaCounter++;
                            if (stanzaCounter % 5 === 0) {
                                className = 'bg-amber-100/50 rounded-lg p-2';
                            }
                        }
                        stanzaLabel = stanzaCounter > 0 ? `<span class="font-bold text-sm text-red-700/70 mr-2 md:mr-0">${stanzaCounter}.</span>` : '';
                        
                    } else if (line.type === 'invocation' || line.type === 'doha') {
                        stanzaCounter = 0;
                        const title = line.type === 'invocation' ? 'Invocation (‡§¶‡•ã‡§π‡§æ)' : 'Closing Doha (‡§¶‡•ã‡§π‡§æ)';
                        linesHtml.push(`<h2 class="text-xl font-bold text-center text-red-700 pt-4 pb-2 border-t mt-4">${title}</h2>`);
                    }

                    linesHtml.push(`
                        <div class="stanza-container ${className}">
                            <div class="language-grid items-center">
                                <div class="sanskrit">
                                    <span class="md:hidden font-bold text-sm text-red-700/70">Sanskrit: </span>
                                    ${stanzaLabel}${line.sanskrit}
                                </div>
                                <div class="romanized">
                                    <span class="md:hidden font-bold text-sm text-amber-700/70">Romanized: </span>
                                    ${line.romanized}
                                </div>
                                <div class="nepali">
                                    <span class="md:hidden font-bold text-sm text-red-700/70">Nepali: </span>
                                    ${line.nepali}
                                </div>
                            </div>
                        </div>
                    `);
                });

                fullTextDisplay.innerHTML = linesHtml.join('');
            }

            // --- Event Listeners and Initialization ---

            const originalStartScreenHTML = startScreen.innerHTML;

            // Click the wrapper to focus the hidden input field
            typingWrapper.addEventListener('click', () => userInput.focus());

            // Start Button Listener
            startButton.addEventListener('click', startGame);

            // Input Check Listener (The core logic runs on every input event)
            userInput.addEventListener('input', checkInput);
            
            // Next Button Listener
            nextButton.addEventListener('click', nextLine);

            // ENTER key listener (works when line is complete and button is not disabled)
            userInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter' && !nextButton.disabled) {
                    event.preventDefault(); // Stop the default Enter action
                    nextLine();
                }
            });
            
            // Line Selector Listener
            lineSelector.addEventListener('change', jumpToLine);

            // Toggle Full Text View
            toggleFullTextButton.addEventListener('click', () => {
                const isHidden = fullTextDisplay.classList.contains('hidden');
                if (isHidden) {
                    renderFullChalisa();
                    fullTextDisplay.classList.remove('hidden');
                    toggleFullTextButton.textContent = 'Hide Full Chalisa Text';
                } else {
                    fullTextDisplay.classList.add('hidden');
                    toggleFullTextButton.textContent = 'View Full Chalisa Text';
                }
            });

            // Initial setup
            populateLineSelector();
            progressDisplay.textContent = `Line 0 / ${totalLines}`;
        });
    </script>
</body>
</html>
